)
df %>% transmute(
cdr = cdr3,
part = quantity / sum(quantity)
)
df %>% transmute(
cdr = cdr3,
part = (quantity / sum(quantity)) * 100
)
head(df)
data <- read_csv("data/R5b_VH_S10_L001_R1_001aafreq.csv")
dim(data)
str(data)
head(data)
data %>% summarise(total = sum(quantity))
df %>% summarise(total = sum(quantity))
data %>% summarise(total = sum(quantity))
data %>% transmute(
cdr = cdr3,
part = (quantity / sum(quantity)) * 100
)
data[1:5, ]
data[1:5, ]$cdr3
data[1:10, ]$cdr3
data[1, ]
print(data[1, ], n = Inf)
str(data[1, ])
getwd()
dir()
files <- dir("./data/parsed/")
files
print(file)
print(f)
seq_along(files)
seq(files)
seq_len(files)
print(f)
files <- dir("./data/parsed/")
for (f in seq_along(files)){
print(f)
}
print(files[i])
for (i in seq_along(files)){
print(files[i])
}
source('~/.active-rstudio-document', echo=TRUE)
all
all[1]
source('~/.active-rstudio-document', echo=TRUE)
all
tmp <- read_csv(file.path("./data/parsed", files[i]))
print(file.path("./data/parsed/", files[i]))
read_csv(file.path("./data/parsed", files[i]))
all <- vector()
all[1] <- read_csv(file.path("./data/parsed", files[i]))
all
dim(all)
length(all)
all[1]
all[2]
all[1, 2]
files <- dir("./data/parsed/")
files
library(tidyverse)
library(magrittr)
d <- read_csv("./data/parsed/heidi_ATTILA_ANALISYS_TO_BACKUP_carolnovoid_VH_FinalRound_R4_S4_L001_R1_001aafreq.csv")
d
d$file
d$file %>% unique()
source('~/mcs/study/code/bioinfo/attila/programs/cdr/tmp.R', echo=TRUE)
d
f
a
a <- full_join(d, f)
a
nrow(d) + nrow(f)
nrow(a)
a %>% group_by(file) %>%
summarise(total = sum(quantity))
?n()
a %>% group_by(file) %>%
summarise(total = sum(quantity),
n = n())
nrow(d)
nrow(f)
a %<>% group_by(file) %>%
mutate(rel = quantity/sum(quantity))
a
a %>% sselect(rel)
a %>% select(rel)
a %>% select(rel) %>% sample_n(3)
is_tibble(a)
is_tibble(T)
print(...)
load_cdr <- function(...){
print(...)
}
load_cdr()
load_cdr(c("oi", "hello", "hola"))
load_cdr <- function(...){
for (i in ...){
print(i)
}
load_cdr(c("oi", "hello", "hola"))
?vector
?is_vector
load_cdr <- function(file_names){
is_vector(file_names)
}
load_cdr(c("oi", "hello", "hola"))
load_cdr <- function(file_names){
for (i in file_names){
print(i)
}
load_cdr(c("oi", "hello", "hola"))
character("o")
as.character("a")
dfn <- "o"
dfn
as.character(dfn)
as.character(dfn) <- 1
load_cdr <- function(dataframe_name, file_names){
for (i in file_names){
if (!exists(as.character(dataframe_name))){
dataframe_name <- read_csv(file_names)
}
load_cdr("./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv")
cd
cdr_df
load_cdr(cdr_df, "./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv")
load_cdr <- function(dataframe_name, file_names){
for (i in file_names){
if (!exists(dataframe_name)){
dataframe_name <- read_csv(file_names)
}
load_cdr(cdr_df, "./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv")
cdr_df
exists("cdr_df")
o
o <- "ok"
o
exists(o)
paste(o)
exists(paste(o))
load_cdr <- function(dataframe_name, file_names){
for (i in file_names){
if (!exists(paste(dataframe_name))){
dataframe_name <- read_csv(file_names)
}
load_cdr(cdr_df, "./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv")
load_cdr("cdr_df", "./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv")
cdr_df
load_cdr()
load_cdr
load_cdr <- function(dataframe_name, file_names){
df <- NULL
for (i in file_names){
if (!is_tibble(df)){
df <- read_csv(file_names[i])
} else {
df %<>% read_csv(file_names[i])
}
df
}
load_cdr <- function(file_names){
df <- NULL
for (i in file_names){
if (!is_tibble(df)){
df <- read_csv(file_names[i])
} else {
df %<>% read_csv(file_names[i])
}
df
}
load_cdr(c("data/parsed/mariajac_Isaura_Pd2_140819_R0xR5_b_VH_InitialRound_R0_VH_S1_L001_R1_001aafreq.csv", "data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4c_VH_FinalRound_VLR42c_S10_L001_R1_001aafreq.csv"))
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
getwd()
dir()
c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv")[1]
c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv")[1] %>% read_csv()
is_tibble(NULL)
load_cdr <- function(file_names){
df <- NULL
for (i in file_names){
if (!is_tibble(df)){
df <- read_csv(file_names[i])
} else {
tmp <- read_csv(file_names[i])
df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
load_cdr <- function(file_names){
df <- NULL
for (i in file_names){
if (!is_tibble(df)){
print("if")
print(file_names[i])
# df <- read_csv(file_names[i])
} else {
print("else")
print(file_names[i])
# tmp <- read_csv(file_names[i])
# df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
load_cdr <- function(file_names){
df <- NULL
print(file_names)
for (i in file_names){
if (!is_tibble(df)){
print("if")
print(file_names[i])
# df <- read_csv(file_names[i])
} else {
print("else")
print(file_names[i])
# tmp <- read_csv(file_names[i])
# df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
"hello"[1]
"hello world"[1]
?c
vector("mar ok")
vector(c("mar ok"))
vector(c("mar ok", "ok"))
as.vector(c("mar ok", "ok"))
as.vector(c("mar ok", "ok"))[1]
c("mar", "sol")[1]
c("mar", "sol")[2]
load_cdr <- function(file_names){
df <- NULL
print(file_names)
print(typeof(file_names))
for (i in file_names){
if (!is_tibble(df)){
print("if")
print(file_names[i])
# df <- read_csv(file_names[i])
} else {
print("else")
print(file_names[i])
# tmp <- read_csv(file_names[i])
# df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
c("mar", "sol") %>% typeof()
c("mar", "sol") %>% length()
load_cdr <- function(file_names){
df <- NULL
print(file_names)
print(typeof(file_names))
print(length(file_names))
for (i in file_names){
if (!is_tibble(df)){
print("if")
print(file_names[i])
# df <- read_csv(file_names[i])
} else {
print("else")
print(file_names[i])
# tmp <- read_csv(file_names[i])
# df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
load_cdr <- function(file_names){
df <- NULL
for (i in file_names){
if (!is_tibble(df)){
print("if")
print(i)
# df <- read_csv(file_names[i])
} else {
print("else")
print(i)
# tmp <- read_csv(file_names[i])
# df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4d_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv"))
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv"))
load_cdr <- function(file_names){
df <- NULL
for (i in file_names){
if (!is_tibble(df)){
df <- read_csv(i)
} else {
tmp <- read_csv(i)
df %<>% full_join(tmp)
}
df
}
load_cdr(c("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv", "./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv"))
read_csv("./data/parsed/mariajac_isaura_2_2_isaura_H_0eX4g_L_0aX4c_VH_FinalRound_VHR42g_S13_L001_R1_001aafreq.csv")
read_csv('./data/parsed/mariajac_anteriores_isaura_1_isaura_HR01eXHR41g_LR01aXLR41c_VH_FinalRound_VHR41g_S6_L001_R1_001aafreq.csv')
378 + 459
388 + 469
?str_locate()
fruit <- c("apple", "banana", "pear", "pineapple")
str_locate(fruit, "$")
str_locate(fruit, "a")
str_locate(fruit, "e")
str_locate(fruit, c("a", "b", "p", "p"))
?str_match()
str_sort(files)
files
stopifnot(str_sort(files) == files)
?str_detect()
str_detect(files, "mariajac")
files[str_detect(files, "mariajac")]
str_which(files, 'mariajac')
files[str_detect(files, "isaura")]
files[str_detect(files, "isaura")] %>% str_detect("teste", negate = T)
files[str_detect(files, "isaura")] %>% str_detect("teste")
files[str_detect(files, "isaura")] %>% str_detect("teste") %>% sum()
files
files <- dir("./data/parsed/")
files[str_detect(files, "isaura")] %>% str_detect("teste") %>% sum()
files %>% length()
str_detect(files, "isaura")
str_detect(files, "isaura") %>% sum()
str_detect(files, regex("isaura", ignore_case = T)) %>% sum()
str_detect(files, "(?)isaura") %>% sum()
str_detect(files, "(?i)isaura") %>% sum()
files[str_detect(files, "(?i)isaura")] %>% str_detect("(?)teste", negate = T)
files[str_detect(files, "(?i)isaura")] %>% str_detect("(?i)teste", negate = T)
files[str_detect(files, "(?i)isaura")] %>% str_detect("(?)teste", negate = T) %>% sum()
files[str_detect(files, "(?i)isaura")] %>% str_detect("(?i)teste", negate = T) %>% sum()
files[str_detect(files, "(?i)isaura")] %>% files[str_detect("(?i)teste", negate = T)] %>% files[str_detect("(?i)falho", negate = T)]
files[str_detect(files, "(?i)isaura")] %>%
files[str_detect("(?i)teste", negate = T)]
files[str_detect(files, "(?i)isaura")] %>%
files[.]
files[str_detect(files, "(?i)isaura")]
files[str_detect(files, "(?i)isaura")] %>%
files[str_detect(., "(?i)teste", negate = T)] %>%
files[str_detect("(?i)falho", negate = T)]
files[str_detect(files, "(?i)isaura")] %>%
print(.)
files[str_detect(files, "(?i)isaura")] %>%
files[str_detect(., "(?i)teste", negate = T)]# %>%
?str_detect
files[str_detect(files, "(?i)isaura|teste")]
files[str_detect(files, "(?i)isaura|backup")]
files[str_detect(files, "(?i)isaura")]
files %<>% files[str_detect(files, "(?i)isaura")]
files <- dir("./data/parsed/")
files <- files[str_detect(files, "(?i)isaura")]
files[str_detect(files, "(?!falho)")]
files[str_detect(files, "(?!)falho")]
files[str_detect(files, "(?i)falho")]
files[str_detect(files, "(?!falho).*")]
files[str_detect(files, "(?:(?!falho).*")]
files[str_detect(files, "(?:(?!falho).*)")]
files[str_detect(files, "^(?:(?!falho).)*$")]
files[str_detect(files, "^(?:(?!falho|teste).)*$")]
source('~/mcs/study/code/bioinfo/attila/programs/cdr/tmp.R', echo=TRUE)
load_cdr(files)
files
?sapply
data_path <- "./data/parsed"
files <- dir(data_path)
files[1]
file.path(data_path, files[1])
sapply(files, function(x){file.path(data_path, x)})
files
source('~/mcs/study/code/bioinfo/attila/programs/cdr/tmp.R', echo=TRUE)
load_cdr(files)
source('~/mcs/study/code/bioinfo/attila/programs/cdr/tmp.R', echo=TRUE)
rm(list=ls())
gc()
?read_csv()
data_path <- "./data/parsed"
files <- dir(data_path)
files[1]
files[50]
read_csv(file.path(data_path, files[50]), col_types = "ciidddddddddiiiiiiiiiiiiiiiiiiiic")
length("ciiddddddddiiiiiiiiiiiiiiiiiiiiiiiiiic")
count("ciiddddddddiiiiiiiiiiiiiiiiiiiiiiiiiic")
seq_len("ciiddddddddiiiiiiiiiiiiiiiiiiiiiiiiiic")
read_csv(file.path(data_path, files[50]), col_types = "ciiddddddddiiiiiiiiiiiiiiiiiiiiiiiiiic")
ii <- read_csv(file.path(data_path, files[50]), col_types = "ciiddddddddiiiiiiiiiiiiiiiiiiiiiiiiiic")
str(ii)
source('~/mcs/study/code/bioinfo/attila/programs/cdr/tmp.R', echo=TRUE)
cdr_df
cdr_df %<>% group_by(file)
cdr_df
cdr_df %>% mutate(cdrp = quantity/sum(quantity))
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>% select(cdrp, cdr3, file, quantity)
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>% select(cdrp, cdr3, quantity, file)
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
select(cdrp, cdr3, quantity, file) %>%
filter(cdrp = max(cdrp))
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
select(cdrp, cdr3, quantity, file) %>%
filter(cdrp == max(cdrp))
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
select(cdrp, cdr3, quantity, file) %>%
filter(cdrp == max(cdrp))
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
select(cdrp, cdr3, quantity, file) %>%
filter(cdrp == max(cdrp)) -> ham
ham
ham$cdrp
ham$cdrp %>% unique()
ham$cdrp %>% unique() %>% length()
ham$cdr3 %>% unique() %>% length()
ham$quantity %>% unique() %>% length()
ham$file %>% unique() %>% length()
ham$file
write_rds(cdr_df, file.path(data_path, "isaura_compressed.rds"))
rm(list=ls())
gc()
rm(list=ls())
gc()
cdr_df <- read_rds(file.path(data_path, "isaura_compressed.rds"))
data_path <- "./data/parsed"
cdr_df <- read_rds(file.path(data_path, "isaura_compressed.rds"))
cdr_df
cdr_df$file %>% duplicated()
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
select(cdrp, cdr3, quantity, file) %>%
filter(cdrp == max(cdrp)) -> ham
ham
ham$file
duplicate(ham$file)
duplicated(ham$file)
ham$file[duplicated(ham$file)]
ham$file[duplicated(ham$file)] %>% unique()
files_duplicated <- ham$file[duplicated(ham$file)] %>% unique()
files_duplicated
ham %>% filter(file %in% files_duplicated)
ham %>% select(cdrp, cdr3, quantity, file) %>%
filter(file %in% files_duplicated) %>%
filter(cdrp == max(cdrp))
ham %>% select(cdrp, cdr3, quantity, file) %>%
filter(file %in% files_duplicated) %>%
filter(cdrp == max(cdrp)) -> bagar
bagar$file
bagar$file %>% unique()
wh <- read_csv(file.path(data_path, "mariajac_isaura_2_2_isaura_H_0eX4g_L_0bX4c_VH_FinalRound_VLR42c_S10_L001_R1_001aafreq.csv"), col_types = "ciiddddddddiiiiiiiiiiiiiiiiiiiiiiiiiic")
wh
print(wh, n = Inf)
wh
wh %>% select(cdr3, quantity, file)
100/6
bagar
cdr_df
ham
?max
ham
cdr_df
cdr_df %>% arrange(quantity)
cdr_df %>% arrange(-quantity)
cdr_df %>% arrange(-quantity) %>% slice_head(n = 1)
cdr_df %>% arrange(-quantity) %>% slice_head(n = 2)
cdr_df %>% arrange(-quantity) %>% slice_head(n = 5)
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
slice_head(n = 5)
cdr_df %>% mutate(cdrp = quantity/sum(quantity)) %>%
slice_head(n = 5) -> cdr
cdr
?select
cdr %>% select(cdrp, cdr3, quantity, everything())
cdr %<>% select(cdr3, cdrp, everything())
cdr
cdr %<>% select(cdr3, cdrp, everything()) %>%
arrange(cdrp)
cdr
?arrange
cdr %<>% select(cdr3, cdrp, everything()) %>%
arrange(cdrp, .by_group = TRUE)
cdr
cdr %<>% select(cdr3, cdrp, everything()) %>%
arrange(-cdrp, .by_group = TRUE)
cdr
ggplot(cdr) +
geom_point(aes(cdrp, MW, color = file))
?scale_color_discrete
ggplot(cdr) +
geom_point(aes(cdrp, MW, color = file)) +
scale_color_discrete(name = "")
ggplot(cdr) +
geom_point(aes(cdrp, MW, color = file)) +
scale_color_discrete(labels = NULL)
cdr %>% slice_head(n = 2) %>%
ggplot() +
geom_point(aes(cdrp, MW, color = file)) +
scale_color_discrete(labels = NULL)
cdr %>% slice_head(n = 2) %>%
ggplot() +
geom_point(aes(cdrp, quantity, color = file)) +
scale_color_discrete(labels = NULL)
cdr %>% slice_head(n = 2) %>%
ggplot() +
geom_point(aes(cdrp, log(quantity), color = file)) +
scale_color_discrete(labels = NULL)
cdr %>% slice_head(n = 1) %>%
ggplot() +
geom_point(aes(cdrp, log(quantity), color = file)) +
scale_color_discrete(labels = NULL)
